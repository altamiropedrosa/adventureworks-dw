version: 2
models:
  - name: dim_territorios
    description: Essa é a dimensão com informações de territórios de vendas da Adventure Works
    tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('stg_sap_adw_vendas_territorios')
    columns:
      - name: sk_territorio
        description: Sk do território. Chave Surrogate key (SK) da dimensão
        tests:
          - unique
          - not_null
       
      - name: id_territorio
        description: Id do motivo de venda. Chave de negócio (NK) da tabela pedidos de vendas
        tests:
          - unique
          - not_null

      - name: nm_territorio
        description: Nome do território de vendas
        tests:
          - not_null

      - name: cd_pais
        description: Código do país do território de vendas
        tests:
          - not_null

      - name: nm_pais
        description: Nome do país do território de vendas

      - name: cd_moeda
        description: Código da moeda aceita no território de vendas

      - name: nm_moeda
        description: Nome da moeda aceita no território de vendas

      - name: ds_grupo_territorio
        description: Descrição do grupo do território de vendas
            
      - name: vl_venda_ytd
        description: Valor de venda YTD do território de vendas

      - name: vl_venda_ultimo_ano
        description: Valor de venda do último ano do território de vendas

      - name: vl_custo_ytd
        description: Valor de custo YTD do território de vendas

      - name: vl_custo_ultimo_ano
        description: Valor de custo do último ano do território de vendas

      - name: dt_modificacao
        description: Data de modificação do registro de vendas

      - name: dt_carga
        description: Data de carga do registro de vendas

